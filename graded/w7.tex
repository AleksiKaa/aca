\documentclass[11pt,a4paper]{article}
\input{auxiliary.tex}

%-----------------------------------------------
%-----------------------------------------------

\title{CS-E4500 Advanced Course in Algorithms}
\author{Aleksi Kääriäinen  \\
	Aalto University  \\
	}

\begin{document}

\date{\today}

\maketitle

\newpage

\section*{Week 7 exercices}

\begin{enumerate}
    \item
          \begin{enumerate}
              \item The outcomes for a one-qubit system are 0 and 1. The probabilities of those outcomes are:
                    \begin{align*}
                        \mathbb{P}(0) & = \left | \frac{1 - i}{2} \right |^2 = \sqrt{\frac{1 - i}{2}\cdot \frac{1 + i}{2}}^2
                        = \frac{1 + i - i - i^2}{4} = \frac{1}{2}                                                            \\
                        \mathbb{P}(1) & = \left | \frac{1 + i}{2} \right |^2 = \sqrt{\frac{1 + i}{2}\cdot \frac{1 - i}{2}}^2
                        = \frac{1 + i - i - i^2}{4} = \frac{1}{2}
                    \end{align*}
              \item The state is:
                    \begin{align*}
                        \begin{bmatrix}
                            \alpha_0 \\ \alpha_1
                        \end{bmatrix} = H|0\ket = \frac{1}{\sqrt{2}}\begin{bmatrix}
                                                                        1 & 1 \\ 1 & -1
                                                                    \end{bmatrix} \begin{bmatrix}
                                                                                      1 \\ 0
                                                                                  \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix}
                                                                                                                         1 \\ 1
                                                                                                                     \end{bmatrix}
                    \end{align*}
                    With probabilities:
                    \begin{align*}
                        \mathbb{P}(\alpha_0) = \mathbb{P}(\alpha_1) = \sqrt{\left(\frac{1}{\sqrt{2}}\right)^2}^2 = \frac{1}{2}
                    \end{align*}
              \item Working in the same basis, $|00\ket = |0\ket \otimes |0\ket = \begin{bmatrix}
                            1 & 0 & 0 & 0
                        \end{bmatrix}^T$.
                    \begin{align*}
                          & CH(H \otimes H)                                                                                                                                                      \\
                        = & CH((I \otimes H)(H \otimes I))                                                                                                                                       \\
                        = & \begin{bmatrix}
                                1 & 0 & 0                  & 0                   \\
                                0 & 1 & 0                  & 0                   \\
                                0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}  \\
                                0 & 0 & \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{2}} \\
                            \end{bmatrix} \left( \left(\begin{bmatrix}
                                                               1 & 0 \\ 0 & 1
                                                           \end{bmatrix} \otimes \frac{1}{\sqrt{2}}\begin{bmatrix}
                                                                                                       1 & 1  \\
                                                                                                       1 & -1
                                                                                                   \end{bmatrix}\right) \left( \frac{1}{\sqrt{2}}\begin{bmatrix}
                                                                                                                                                     1 & 1  \\
                                                                                                                                                     1 & -1
                                                                                                                                                 \end{bmatrix} \otimes \begin{bmatrix}
                                                                                                                                                                           1 & 0 \\ 0 & 1
                                                                                                                                                                       \end{bmatrix} \right) \right) \\
                        = & \begin{bmatrix}
                                1 & 0 & 0                  & 0                   \\
                                0 & 1 & 0                  & 0                   \\
                                0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}  \\
                                0 & 0 & \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{2}} \\
                            \end{bmatrix} \cdot \frac{1}{2} \begin{bmatrix}
                                                                1 & 1  & 0 & 0  \\
                                                                1 & -1 & 0 & 0  \\
                                                                0 & 0  & 1 & 1  \\
                                                                0 & 0  & 1 & -1
                                                            \end{bmatrix} \begin{bmatrix}
                                                                              1 & 0 & 1  & 0  \\
                                                                              0 & 1 & 0  & 1  \\
                                                                              1 & 0 & -1 & 0  \\
                                                                              0 & 1 & 0  & -1
                                                                          \end{bmatrix}                                                                                         \\
                        = & \frac{1}{2} \begin{bmatrix}
                                            1 & 0 & 0                  & 0                   \\
                                            0 & 1 & 0                  & 0                   \\
                                            0 & 0 & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}  \\
                                            0 & 0 & \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{2}} \\
                                        \end{bmatrix} \begin{bmatrix}
                                                          1 & 1  & 1  & 1  \\
                                                          1 & -1 & 1  & -1 \\
                                                          1 & 1  & -1 & -1 \\
                                                          1 & -1 & -1 & 1  \\
                                                      \end{bmatrix}                                                                             \\
                        = & \begin{bmatrix}
                                \frac{1}{2}        & \frac{1}{2}        & \frac{1}{2}         & \frac{1}{2}         \\
                                \frac{1}{2}        & \frac{-1}{2}       & \frac{1}{2}         & \frac{-1}{2}        \\
                                \frac{1}{\sqrt{2}} & 0                  & \frac{-1}{\sqrt{2}} & 0                   \\
                                0                  & \frac{1}{\sqrt{2}} & 0                   & \frac{-1}{\sqrt{2}}
                            \end{bmatrix}
                    \end{align*}
                    Thus:
                    \begin{align*}
                        \begin{bmatrix}
                            \alpha_{00} \\ \alpha_{01} \\ \alpha_{10} \\ \alpha_{11}
                        \end{bmatrix} =
                        CH(H \otimes H)|00\ket
                        =  \begin{bmatrix}
                               \frac{1}{2}        & \frac{1}{2}        & \frac{1}{2}         & \frac{1}{2}         \\
                               \frac{1}{2}        & \frac{-1}{2}       & \frac{1}{2}         & \frac{-1}{2}        \\
                               \frac{1}{\sqrt{2}} & 0                  & \frac{-1}{\sqrt{2}} & 0                   \\
                               0                  & \frac{1}{\sqrt{2}} & 0                   & \frac{-1}{\sqrt{2}}
                           \end{bmatrix} \begin{bmatrix}
                                             1 \\ 0 \\ 0 \\ 0
                                         \end{bmatrix}
                        = \begin{bmatrix}
                              \frac{1}{2} \\ \frac{1}{2} \\ \frac{1}{\sqrt{2}} \\ 0
                          \end{bmatrix}
                    \end{align*}
                    And the two-bit outcomes have the probabilities:
                    \begin{align*}
                        \mathbb{P}(\alpha_{00}) & = \mathbb{P}(\alpha_{01}) = \left(\frac{1}{2}\right)^2 = \frac{1}{4} \\
                        \mathbb{P}(\alpha_{10}) & = \left(\frac{1}{\sqrt(2)}\right)^2 = \frac{1}{2}                    \\
                        \mathbb{P}(\alpha_{11}) & = 0
                    \end{align*}
              \item The circuit corresponding to the state is:
                    \begin{center}
                        \includegraphics[scale=0.5]{pics/circuit.png}
                    \end{center}
          \end{enumerate}
          \newpage

    \item
          \begin{enumerate}
              \item The value table of $M_3$:
                    \begin{center}
                        \begin{tabular}{c|c|c|c|c}
                            $x_0$ & $x_1$ & $x_2$ & $x_0 + x_1 + x_2$ & $M_3$ \\
                            \hline
                            1     & 1     & 1     & 3                 & 1     \\
                            1     & 1     & 0     & 2                 & 1     \\
                            1     & 0     & 1     & 2                 & 1     \\
                            1     & 0     & 0     & 1                 & 0     \\
                            0     & 1     & 1     & 2                 & 1     \\
                            0     & 1     & 0     & 1                 & 0     \\
                            0     & 0     & 1     & 1                 & 0     \\
                            0     & 0     & 0     & 0                 & 0     \\
                        \end{tabular}
                    \end{center}
              \item The function $M_3$ is logically equivalent to the formula $(x_0 \land x_1) \lor (x_0 \land x_2) \lor (x_1 \land x_2)$. The formula can be formed into a boolean circuit
                    with 8 bits. Additional bits are needed to keep track of intermediary results.
                    \begin{center}
                        \includegraphics[scale=0.25]{pics/boolean_circuit.jpg}
                    \end{center}
              \item Transforming the circuit from part (b) to a reversible boolean circuit using the gate transformations
                    from the lecture slides:
                    \begin{center}
                        \includegraphics[scale=0.25]{pics/rev_circuit.jpg}
                    \end{center}
              \item Transforming the circuit from part (c) to a quantum circuit:
                    \begin{align*}
                        G = & X^{[8|0]} X^{[8|1]} X^{[8|2]} CCX^{[8|2, 1, 0]} X^{[8|1]} X^{[8|2]} X^{[8|1]} X^{[8|3]} X^{[8|4]} \cdot \\
                            & CCX^{[8|4, 3, 1]} X^{[8|3]} X^{[8|4]} CCX^{[8|6, 5, 2]} CCX^{[8|7, 5, 3]} CCX^{[8|7, 6, 4]}
                    \end{align*}
                    Since there are 8 qubits in the register, $q = 8$, and thus:
                    \begin{align*}
                        U_{M_3} & = G^{[8|5, 6, 7, 0, 4, 3, 2, 1]} \text{, with} \\
                        W       & = ((x_0 \land x_1), (x_0 \land x_2), (x_1 \land x_2), ((x_0 \land x_1) \lor (x_0 \land x_2)))
                    \end{align*}
          \end{enumerate}
          \newpage

    \item

          \newpage

    \item

          \newpage
\end{enumerate}
\end{document}
